<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{.Title}}</title>
<style>
  body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #f4f6f9; margin: 0; padding: 20px; color: #2d3436; }
  .container { max-width: 720px; margin: 0 auto; background: #fff; border-radius: 12px; box-shadow: 0 2px 12px rgba(0,0,0,0.08); overflow: hidden; }
  .header { background: linear-gradient(135deg, #0c2461 0%, #1e3799 50%, #0a3d62 100%); color: #fff; padding: 32px 28px; text-align: center; }
  .header h1 { margin: 0 0 4px 0; font-size: 24px; letter-spacing: -0.5px; }
  .header .subtitle { font-size: 14px; opacity: 0.85; }
  .section-title { background: #f8f9fa; padding: 12px 20px; font-size: 15px; font-weight: 700; color: #0c2461; border-bottom: 2px solid #1e3799; border-top: 1px solid #eee; }
  .market-table { width: 100%; border-collapse: collapse; font-size: 13px; }
  .market-table th { background: #f0f2f5; padding: 8px 10px; text-align: center; font-weight: 600; color: #636e72; font-size: 11px; text-transform: uppercase; letter-spacing: 0.5px; }
  .market-table th:first-child { text-align: left; }
  .market-table td { padding: 8px 10px; border-bottom: 1px solid #f0f2f5; text-align: center; font-size: 13px; }
  .market-table td:first-child { text-align: left; font-weight: 600; color: #2d3436; }
  .positive { color: #22c55e; }
  .negative { color: #ef4444; }
  .neutral { color: #9ca3af; }
  .bg-pos { background: #f0fdf4; }
  .bg-neg { background: #fef2f2; }
  .movers-title { background: #f8f9fa; padding: 10px 20px; font-size: 13px; font-weight: 600; color: #0c2461; border-top: 1px solid #eee; }
  .movers-grid { display: flex; gap: 16px; padding: 12px 20px; flex-wrap: wrap; }
  .movers-col { flex: 1; min-width: 180px; }
  .movers-col h4 { margin: 0 0 8px 0; font-size: 13px; font-weight: 700; }
  .mover-item { font-size: 13px; padding: 3px 0; }
  .divider { background: linear-gradient(135deg, #0a3d62, #1e3799); color: #fff; padding: 16px 20px; font-size: 16px; font-weight: 700; text-align: center; letter-spacing: 0.3px; }
  .content { padding: 24px 28px; }
  .article { border-bottom: 1px solid #eee; padding: 18px 0; }
  .article:last-child { border-bottom: none; }
  .article-rank { display: inline-block; background: #0c2461; color: white; width: 28px; height: 28px; border-radius: 50%; text-align: center; line-height: 28px; font-size: 13px; font-weight: bold; margin-right: 10px; vertical-align: top; }
  .article-title { font-size: 16px; font-weight: 600; }
  .article-title a { color: #0c2461; text-decoration: none; }
  .article-title a:hover { text-decoration: underline; }
  .article-meta { font-size: 12px; color: #636e72; margin-top: 4px; }
  .article-summary { font-size: 14px; color: #4a4a4a; margin-top: 8px; line-height: 1.5; }
  .article-keywords { margin-top: 6px; }
  .keyword-tag { display: inline-block; background: #dfe6e9; color: #2d3436; font-size: 11px; padding: 2px 8px; border-radius: 10px; margin-right: 4px; margin-bottom: 2px; }
  .score-badge { display: inline-block; background: #00b894; color: white; font-size: 11px; padding: 2px 8px; border-radius: 10px; margin-left: 6px; }
  .read-more { display: inline-block; margin-top: 8px; font-size: 13px; color: #1e3799; text-decoration: none; font-weight: 500; }
  .read-more:hover { text-decoration: underline; }
  .footer { background: #f8f9fa; padding: 16px 20px; font-size: 12px; color: #636e72; border-top: 1px solid #eee; text-align: center; }
  .footer .sources { margin-top: 8px; }
  .empty-state { text-align: center; padding: 40px 20px; color: #636e72; }
  .empty-state h2 { font-size: 18px; color: #2d3436; }
  @media (max-width: 600px) {
    body { padding: 8px; }
    .container { border-radius: 8px; }
    .header { padding: 20px 16px; }
    .header h1 { font-size: 20px; }
    .market-table { font-size: 11px; }
    .market-table th, .market-table td { padding: 6px 4px; }
    .section-title { padding: 10px 16px; font-size: 14px; }
    .hide-mobile { display: none; }
    .content { padding: 16px; }
  }
</style>
</head>
<body>
<div class="container">
  <div class="header">
    <h1>{{.Title}}</h1>
    <div class="subtitle">{{.Date}} (SGT){{if .HasMarket}} &mdash; {{.ViewName}}{{end}}</div>
  </div>

  {{if .HasMarket}}
  {{range .Sections}}
  <div class="section-title">{{.Name}}</div>
  <table class="market-table">
    <thead>
      <tr>
        <th>Market</th>
        <th>Price</th>
        <th>1D</th>
        <th>1W</th>
        <th class="hide-mobile">1M</th>
        <th class="hide-mobile">3M</th>
        <th>1Y</th>
        <th class="hide-mobile">5Y</th>
        <th>Trend</th>
      </tr>
    </thead>
    <tbody>
      {{range .Rows}}
      <tr>
        <td>{{.Name}}</td>
        <td>{{.Price}}</td>
        <td class="{{if gt .ChangePct 0.0}}bg-pos positive{{else if lt .ChangePct 0.0}}bg-neg negative{{else}}neutral{{end}}">{{.ChangePctStr}} {{.ChangeArrow}}</td>
        {{range $i, $h := .Historical}}{{if eq $i 0}}<td class="{{$h.Class}}">{{$h.Value}}</td>
        {{else if eq $i 1}}<td class="{{$h.Class}} hide-mobile">{{$h.Value}}</td>
        {{else if eq $i 2}}<td class="{{$h.Class}} hide-mobile">{{$h.Value}}</td>
        {{else if eq $i 4}}<td class="{{$h.Class}}">{{$h.Value}}</td>
        {{else if eq $i 6}}<td class="{{$h.Class}} hide-mobile">{{$h.Value}}</td>
        {{end}}{{end}}
        <td>{{trendArrow .TrendPct}}</td>
      </tr>
      {{end}}
    </tbody>
  </table>
  {{end}}

  {{if .HasMovers}}
  <div class="section-title">Top Movers</div>
  {{range .Movers}}
  <div class="movers-title">{{.Region}}</div>
  <div class="movers-grid">
    <div class="movers-col">
      <h4 class="positive">&#9650; Top Gainers</h4>
      {{range .Gainers}}<div class="mover-item {{.Class}}">{{.Name}}: {{.ChangePct}}</div>{{end}}
    </div>
    <div class="movers-col">
      <h4 class="negative">&#9660; Top Losers</h4>
      {{range .Losers}}<div class="mover-item {{.Class}}">{{.Name}}: {{.ChangePct}}</div>{{end}}
    </div>
  </div>
  {{end}}
  {{end}}
  {{end}}

  {{if .HasNews}}
  {{if .HasMarket}}<div class="divider">News &amp; Analysis</div>{{end}}
  <div class="content">
    {{if .Articles}}
    {{range $i, $a := .Articles}}
    <div class="article">
      <div>
        <span class="article-rank">{{add $i 1}}</span>
        <span class="article-title"><a href="{{$a.Link}}">{{$a.Title}}</a></span>
        {{if gt $a.Score 0}}<span class="score-badge">Score: {{$a.Score}}</span>{{end}}
      </div>
      <div class="article-meta">{{$a.Source}} &middot; {{formatTime $a.PublishedAt}}</div>
      {{if $a.Summary}}<div class="article-summary">{{$a.Summary}}</div>{{end}}
      {{if $a.Keywords}}
      <div class="article-keywords">
        {{range $a.Keywords}}<span class="keyword-tag">{{.}}</span>{{end}}
      </div>
      {{end}}
      <a href="{{$a.Link}}" class="read-more">Read More &rarr;</a>
    </div>
    {{end}}
    {{else}}
    <div class="empty-state">
      <h2>No articles found</h2>
      <p>No relevant articles were found in the last 24 hours. Check back later.</p>
    </div>
    {{end}}
  </div>
  {{end}}

  <div class="footer">
    {{if .HasNews}}<strong>Sources:</strong>
    <div class="sources">{{range .Sources}}{{.}} &bull; {{end}}</div>
    <div style="margin-top:6px;">Articles scanned: {{.TotalFound}}</div>{{end}}
    <div style="margin-top:10px;">Generated: {{.Generated}} | Powered by OpenClaw Market Intel</div>
  </div>
</div>
</body>
</html>
